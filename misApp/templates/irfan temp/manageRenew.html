{% extends 'dashboard.html'%}
{% load staticfiles%}
{% block form1Title%}
Renew Subscription:
{%endblock%}


{% block leftMenu %}
              <div id="left_menu">
                    <ul id="main_menu" class="main_menu">
                      <li ><a href="/subscription/list"><span class="ico gray shadow pictures_folder" ></span><b>Subscription</b></a></li>
                      <li ><a href="/customer/"><span class="ico gray shadow pictures_folder" ></span><b>Subscriber</b></a></li>
                      <li class="select"><a href="/subscription/renew"><span class="ico gray shadow pictures_folder" ></span><b>Lapse Subscription</b></a></li>
                      <li><a href="/compliment/"><span class="ico gray shadow pictures_folder" ></span><b>Complimentary</b></a></li>
                      <li ><a href="/suspended/"><span class="ico gray shadow pictures_folder" ></span><b>Suspended</b></a></li>
                    </ul>
                    
                    <div id="footer"> &copy; Copyright 2013  </div>
              </div>
{%endblock%}

              
{%block widgetContent%}





<script>

function getMagIds()
{

var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  
  
  xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    var selectedMags=[];
    var sumOfOfferPrice=0;
    var allMags=xmlhttp.responseText.split(',');
    for(x=0;x<allMags.length-1;x++)
    {
     try
     {
        if(document.forms['form1']['c_'+allMags[x]].checked)
        {
            selectedMags.push(allMags[x]);
            if(document.forms['form1']['realAmount_'+allMags[x]].value!="")
            {
            	if(isNaN(parseInt(document.forms['form1']['realAmount_'+allMags[x]].value)))
            	{
            	//alert('Invalid offer Amount '+document.forms['form1']['realAmount_'+allMags[x]].value);
            	}
            	else
            	{
            	sumOfOfferPrice=sumOfOfferPrice+parseInt(document.forms['form1']['realAmount_'+allMags[x]].value);
            	}
            }
            
        }
     }
     catch(e){alert(e);}
    }
    //alert('selected mag:'+selectedMags);
    setRecsWithoutScheme(selectedMags+':'+document.getElementById('received').value+':'+document.getElementById('selectOfsubsource').value+':'+sumOfOfferPrice);
    //alert(selectedMags+':'+document.getElementById('received').value+':'+document.getElementById('selectOfsubsource').value+':'+sumOfOfferPrice);
    //alert(document.getElementById('set recs called'));
    //location.href='/responder?setRecs='+selectedMags+':'+document.getElementById('received').value+':'+document.getElementById('selectOfsubsource').value+':'+sumOfOfferPrice;
              
    }
  }
xmlhttp.open("GET","/responder?getMagIds=0",true);
xmlhttp.send();
}




function setRecsWithoutScheme(concatedString)
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    var recAmnts=xmlhttp.responseText.split('|')[0].split(':');
    
    for(x=0;x<recAmnts.length-1;x++)
    {
     	
     	try{
     	document.forms['form1']['recAmount_'+recAmnts[x].split(',')[0]].value=recAmnts[x].split(',')[1];
     	}catch(e)
     	{alert(e);}
    }
    
    document.getElementById('comdis').value=xmlhttp.responseText.split('|')[1];
    document.getElementById('addis').value=xmlhttp.responseText.split('|')[2];
    document.getElementById('ocharge').value=xmlhttp.responseText.split('|')[3];
    document.getElementById('SumOfRecAmnt').value=document.getElementById('received').value;
    document.getElementById('forshow').value=document.getElementById('received').value;
    
    }
  }
xmlhttp.open("GET","/responder?setRecs="+concatedString,true);
xmlhttp.send();

}





function setRecAmount(TRA)
{

var i=document.getElementById('selectOfschemes').selectedIndex;
var value=document.getElementById('selectOfschemes').options[i].value;

var j=document.getElementById('selectOfsubsource').selectedIndex;
var value2=document.getElementById('selectOfsubsource').options[j].value;

var data=value+','+TRA+','+value2



var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    var recAmnts=xmlhttp.responseText.split('|')[0].split(':');
    
    for(x=0;x<recAmnts.length-1;x++)
    {
     	
     	try{
     	document.forms['form1']['recAmount_'+recAmnts[x].split(',')[0]].value=recAmnts[x].split(',')[1];
     	}catch(e)
     	{alert(e);}
    }
    
    document.getElementById('comdis').value=xmlhttp.responseText.split('|')[1];
    document.getElementById('addis').value=xmlhttp.responseText.split('|')[2];
    document.getElementById('ocharge').value=xmlhttp.responseText.split('|')[3];
    document.getElementById('SumOfRecAmnt').value=TRA;
    document.getElementById('forshow').value=TRA;
    
    }
  }
xmlhttp.open("GET","/responder?schemeAndTRA="+data,true);
xmlhttp.send();

}













function setPopBranch(id)
{

var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  
  
  xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    
    //alert(xmlhttp.responseText);
    document.getElementById("idOf_popBranch").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","/responder?popBranch="+id,true);
xmlhttp.send();
}

function setPopSource(id)
{

var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  
  
  xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    
    //alert(xmlhttp.responseText);
    document.getElementById("idOf_popSource").innerHTML=xmlhttp.responseText;
    
    }
  }
xmlhttp.open("GET","/responder?popSource="+id,true);
xmlhttp.send();
}

function fillFormBySchemeId(id)
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  
  
  xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    
    //alert(xmlhttp.responseText);
    document.getElementById("div_payment").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","/responder?scheme="+id,true);
xmlhttp.send();
}










function calcAge(dobString) {
  dobString=dobString.split("-")
  dobString=dobString[1]+'/'+dobString[0]+'/'+dobString[2];
  
  var birthday = new Date(dobString);
  var age=~~((Date.now() - birthday) / (31557600000));
  if(age<2)
  {alert("please enter valid birth date!");}
  else{
  document.getElementById('age').value=age;}
}

function calcSUMEA(len)
{

var sum=0;
for (x=1;x<=len;x++)
{
 sum=parseInt(sum)+parseInt(document.getElementById('estimatedAmount_'+x).value);
}
document.getElementById('SumOfEAmnt').value=sum;
if (document.getElementById('SumOfRAmnt').value=='')
{}
else
{discount=document.getElementById('discount').value=sum-parseInt(document.getElementById('SumOfRAmnt').value);}
if(discount<0)
{alert('Invalid discount '+discount);}
}

function calcSUMRA(len)
{

var sum=0;
for (x=1;x<=len;x++)
{
 enteredvalue=document.getElementById('realAmount_'+x).value;
 if(enteredvalue=="")
 {sum=parseInt(sum)+0;}
 
 else if(isNaN(parseInt(enteredvalue)))
 {
 sum=parseInt(sum)+0;
 alert("Please correct subscription amount '"+enteredvalue+"'")
 }
 else
 {
 sum=parseInt(sum)+parseInt(document.getElementById('realAmount_'+x).value);
 }
 
}
document.getElementById('SumOfRAmnt').value=sum;

discount=document.getElementById('discount').value=parseInt(document.getElementById('SumOfEAmnt').value)-sum;
if(discount<0)
{alert('Invalid discount '+discount);}

}



function calcSUMRecA(len)
{

var sum=0;
for (x=1;x<=len;x++)
{
 enteredvalue=document.getElementById('recAmount_'+x).value;
 if(enteredvalue=="")
 {sum=parseInt(sum)+0;}
 
 else if(isNaN(parseInt(enteredvalue)))
 {
 sum=parseInt(sum)+0;
 alert("Please correct received amount '"+enteredvalue+"'");
 }
 else
 {
 sum=parseInt(sum)+parseInt(document.getElementById('recAmount_'+x).value);
 }
 
}
document.getElementById('SumOfRecAmnt').value=sum;
document.getElementById('forshow').value=sum;
document.getElementById('received').value=sum;

}




function getMagEstimatedAmnt(magId,period,len,txtId)
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    if (period==-1){period=0;}
    
    var x;
    //alert("returned:"+xmlhttp.responseText);
    ea=xmlhttp.responseText*period;
    document.getElementById('estimatedAmount_'+txtId).value=ea;
    
    calcSUMEA(len);
    }
  }
xmlhttp.open("GET","/responder?magId="+magId,true);
xmlhttp.send();
}

function getSubSources(sourceId)
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("sub_source_div").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","/responder?source="+sourceId,true);
xmlhttp.send();
}


function getState(countryId)
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("statediv").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","/responder?country="+countryId,true);
xmlhttp.send();
}



function getCity(stateId)
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("citydiv").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","/responder?state="+stateId,true);
xmlhttp.send();
}




function getSchemeByMagazine(id)
{

var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    
    document.getElementById("schemeselect").innerHTML=xmlhttp.responseText;
    
    }
  }
xmlhttp.open("GET","/responder?magazine="+id,true);
xmlhttp.send();
}

function fillFormByComboId(id)
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    //document.getElementById("schemeselect").innerHTML=xmlhttp.responseText;
    //alert(xmlhttp.responseText);
    var arr=xmlhttp.responseText.split('|');
    var mags=arr[0].split(',');
    var schemes=arr[1].split(',');
    var gifts=arr[2].split(',');
    
     for(m in mags)
     {
       try
       {
       //alert('c_'+mags[m]);
       document.getElementById('c_'+mags[m]).checked = true;
       }
       catch(e){}
     }
     
    
     
    }
  }
xmlhttp.open("GET","/responder?combo="+id,true);
xmlhttp.send();
}

 


function enableGroup(value)
{
if (value=='g')
{
document.getElementById("gDiv").innerHTML="<label> Group Name <sup>*</sup></label><div> <input type='text' name='groupName' class='medium'  value='{{groupName}}' /></div>";

}
else
{
document.getElementById("gDiv").innerHTML="<label> Group Name </label><div> <input type='text'  name='groupName' class='medium'  value='{{groupName}}'/></div>";
}
}

</script>

   




    


<div class="content" style="margin:0 10px 0 10px" >
<div style="background:lightyellow;">
      <ul style="color:red;style:disk;">
                	{% for e in errors %}
                	  <li>{{e}}</li>
                	{%endfor%}
      </ul>
      <ul style="color:green;style:disk;">
                	{% for w in warns %}
                	  <li>{{w}}</li>
                	{%endfor%}
      </ul>
      
</div>
		<!-- Smart Wizard -->
  		<div id="wizard" class="swMain" >
  			<ul>

  				<li><a href="#step-1">
                <span class="stepDesc">Personal Detail<br />
                </span>
            </a></li>
  				<li><a href="#step-2">
                <span class="stepDesc">Subscription Detail<br />
                </span>
            </a></li>

             <li><a href="#step-3">
                <span class="stepDesc">Payment Detail<br />
                </span>
            </a></li>
  				
  			</ul>
            
             <form name="form1" method="post" action="" > 
  			<div id="step-1" style="width:100%;">
			          <div class="widget-content" style="width:100%;">
                                    <!-- title box -->

                                           <div class="section" >
                                                <label> Renew Date </label>   
                                                <div> <input type="text" name="date"  value="{{date}}" readonly class="medium"  /></div>
                                           </div>
                                           
                                          
                                           
                                            <div class="section" >
                                                <label>Title <sup>*</sup></label>   
                                                <div  class="selectWidth1"> <select class="small"  name="title">

                                                <option value="-1" selected >Select Title</option>
                                                   {%if customer.title == 'm'%}
                                                   <option value="m"  selected>Mr.</option>
                                                   {%else%}
                                                   <option value="m" >Mr.</option>
                                                   {%endif%}
                                                   
                                                   {%if title == 'f'%}
                                                   <option value="f"  selected>Mrs.</option>
                                                   {%else%}
                                                   <option value="f" >Mrs.</option>
                                                   {%endif%}
                                                   
                                                   
                                                   {%if title == 'mis'%}
                                                   <option value="mis"  selected>Miss</option>
                                                   {%else%}
                                                   <option value="mis" >Miss</option>
                                                   {%endif%}
                                                   
                                                   {%if title == 'd'%}
                                                   <option value="d"  selected>Dr.</option>
                                                   {%else%}
                                                   <option value="d" >Dr.</option>
                                                   {%endif%}
                                                   
                                                   {%if title == 'o'%}
                                                   <option value="o"  selected>Other</option>
                                                   {%else%}
                                                   <option value="o" >Other</option>
                                                   {%endif%}
                                              </select></div>
                                           </div>
                                           <div class="section" >
                                                <label>First Name <sup>*</sup></label>   
                                                <div> <input type="text" name="firstname" value="{{customer.firstName}}" class="medium"  /></div>

                                           </div>
                                           <div class="section" >
                                                <label>Last Name <sup>*</sup></label>   
                                                <div> <input type="text" name="lastname" value="{{customer.lastName}}" class="medium"  /></div>

                                           </div>
                                           <div class="section" >
                                                <label>DOB</label>   
                                                <div> <input type="text" name="dob" class="datepicker" style="text-align:left" value="{%if customer.dob%} {{customer.dob}} {%else%}{%endif%}" class="medium"  onchange="calcAge(this.value);" /></div>

                                           </div>
                                           <div class="section" >
                                                <label>age </label>   
                                                <div> <input type="text" name="age" id="age" value="{%if customer.age%} {{customer.age}} {%else%}{%endif%}" class="small"  /></div>

                                           </div>
                                           
                                           
                                           <div class="section" >
                                                <label>Sex </label>   
                                                <div class="selectWidth1">
                                                <select class="small"  name="sex">
                                                
                                                <option value="-1" selected >Select Sex</option>
                                                   {%if customer.sex == 'm'%}
                                                   <option value="m"  selected>Male</option>
                                                   {%else%}
                                                   <option value="m" >Male</option>
                                                   {%endif%}
                                                   {%if sex == 'f'%}
                                                   <option value="f"  selected>Female.</option>
                                                   {%else%}
                                                   <option value="f" >Female</option>
                                                   {%endif%}
                                                   

                                              </select>       
                                           </div>
                                           </div>
                                           
                                           
                                           <div class="section" >
                                                <label>Designation</label>   
                                                <div> <input type="text" name="designation" class="medium" value="{%if customer.designation%} {{customer.designation}} {%else%}{%endif%}" /></div>
                                           </div>
                                           
                                           <div class="section" >
                                                <label>Company</label>   
                                                <div> <input type="text" name="company" class="medium" value="{%if customer.company%} {{customer.company}} {%else%}{%endif%}" /></div>

                                           </div>
                                           
                                           <div class="section" >
                                                <label>Address Line 1 <sup>*</sup></label>   
                                                <div> <input type="text" name="address1" value="{%if customer.address1%} {{customer.address1}} {%else%}{%endif%}" class="large"  /></div>
                                           </div>
                                           
                                           <div class="section" >
                                                <label>Address Line 2</label>   
                                                <div> <input type="text" name="address2" value="{%if customer.address2%} {{customer.address2}} {%else%}{%endif%}" class="large"  /></div>

                                           </div>
                                           
                                           <div class="section" >
                                                <label>Address Line 3</label>   
                                                <div> <input type="text" name="address3" class="large" value="{%if customer.address3%} {{customer.address3}} {%else%}{%endif%}" /></div>
                                           </div>
                                           
                                           <div class="section" >
                                                <label>State <sup>*</sup></label>   
                                                <div class="selectWidth1" >
                                                	<select class="small"  name="state" onchange="getCity(this.value)">
                                                		<option value="-1"  selected>Select State</option>
                                                	  {%for s in states%}
                                                	    {%ifequal state s.id%}
                                                		<option value="{{s.id}}" selected>{{s.name|title}}</option>
                                                		{%else%}
                                                		<option value="{{s.id}}" >{{s.name|title}}</option>
                                                		{%endifequal%}
                                                      {%empty%}
                                                         <option value="-1" > no states found ! </option>
                                                      {%endfor%}
                                                       	
                                                	</select>
                                                	
                                                	        
                                                </div>
                                           </div>
                                           <div class="section" >
                                                <label>City <sup>*</sup></label>   
                                                <div class="selectWidth1" id="citydiv">
                                                	<select class="small"  name="city" >
                                                	<option value="-1" selected>Select City</option>
                                                	    {%for c in cities%}
                                                	    {%ifequal city c.id%}
                                                	    <option value="{{c.id}}" selected  >{{c.name}}</option>
                                                	    {%else%}
                                                	    <option value="{{c.id}}"  >{{c.name}}</option>
                                                	    {%endifequal%}
                                                	    {%empty%}
                                                		<option value="-1" selected  >Select State First</option>
                                                		{%endfor%}
                                                	</select>       
                                           </div>
                                           </div>
                                           
                                           <div class="section" >
                                                <label>Pincode <sup>*</sup></label>   
                                                <div> <input type="text" name="pincode" value="{%if customer.pincode%} {{customer.pincode}} {%else%}{%endif%}" class="medium"  /></div>

                                           </div>
                                           
                                           <div class="section" >
                                                <label>Telephone (O)</label>   
                                                <div> <input type="text" name="teleo" value="{%if customer.tel_O%} {{customer.tel_O}} {%else%}{%endif%}" class="medium"  /></div>
                                           </div>
                                           
                                           <div class="section" >
                                                <label>Telephone (R)</label>   
                                                <div> <input type="text" name="teler" value="{%if customer.tel_R%} {{customer.tel_R}} {%else%}{%endif%}" class="medium"  /></div>

                                           </div>
                                           
                                           <div class="section" >
                                                <label>Mobile no.</label>   
                                                <div> <input type="text" name="mobileno" value="{%if customer.mobileNo%} {{customer.mobileNo}} {%else%}{%endif%}" class="medium"  /></div>
                                           </div>
                                           
                                              <div class="section" >
                                                <label>Email Id </label>   
                                                <div> <input type="text" name="email" value="{%if customer.email%} {{customer.email}} {%else%}{%endif%}" class="medium"  /></div>

                                           </div>
                                </div>
            
			
			</div>
  			<div id="step-2" style="width:100%;">
			           <div class="widget-content">
                                    <!-- title box -->
                                    
                                     
                                            <div class="section" >
                                                <label> Renew Date </label>   
                                                <div> <input type="text" name="date" value="{{date}}" class="medium" readonly /></div>

                                            </div>
                                            
                                             
                                            
                                            
                                             <div id="idOf_popSource">
                                             <div class="section" >
                                                <label>Main Source <sup>*</sup></label>   
                                                <div class="selectWidth1">
                                                <table border="0">
                                                <tr>
                                                <td>
                                                
                                                
                                                <select class="small"  name="source"  onchange="getSubSources(this.value);">
                                                		<option value="-1"  selected>Select Source</option>
                                                	  {%for s in sources%}
                                                	    {%ifequal source s.id%}
                                                		<option value="{{s.id}}" selected>{{s.categoryName|title}}</option>
                                                		{%else%}
                                                		<option value="{{s.id}}" >{{s.categoryName|title}}</option>
                                                		{%endifequal%}
                                                      {%empty%}
                                                         <option value="-1" > no sources found ! </option>
                                                      {%endfor%}
                                                       	
                                                	</select>
                                                
                                                
                                                </td>
                                                <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                <td ><a href="" onclick="return openURLInCenterOfScreen('/add/source');"><img src="{% static 'images/icon_addlink.gif' %}"></a></td>
                                                </tr>       
                                                </table>
                                                	
                                                	
                                                	        
                                                </div>
                                           </div>     
                                                                                 
                                           <div class="section" >
                                                <label>Sub source <sup>*</sup></label>   
                                                <div class="selectWidth1"  id="sub_source_div" >
                                                    <table border="0">
                                                <tr>
                                                <td>
                                                
                                                
                                                <select class="small"  name="subSource" id="selectOfsubsource">
                                                	    <option value="-1" selected >Select Subsource</option>
                                                	    {%for ss in subsources%}
                                                	    {%ifequal subSource ss.id %}
                                                	    <option value="{{ss.id}}" selected  >{{ss.categoryName}}</option>
                                                	    {%else%}
                                                	    <option value="{{ss.id}}" >{{ss.categoryName}}</option>
                                                	    {%endifequal%}
                                                	    {%empty%}
                                                	    <option value="-1" selected>Select Source First</option>
                                                		{%endfor%}
                                                		
                                                	</select> 
                                                
                                                
                                                </td>
                                                
                                                </tr>       
                                                </table>
                                                	      
                                                </div>
                                           </div>
                                           
                                           </div>
                                            <div class="section" >
                                                <label>Scheme</label>   
                                                <div class="selectWidth1">
                                                   <table>
                                                   <tr>
                                                   <td>
                                                    <div id="schemeselect">
                                                	<select class="small" id="selectOfschemes" name="sschemes"  onchange="fillFormBySchemeId(this.value)">
                                                	  <option value="-1" selected>Select Scheme</option>
                                                	  {%for s in schemes%}
                                                	    {%if s.id in sschemes%}
                                                		<option value="{{s.id}}" selected>{{s.name|title}}</option>
                                                		{%else%}
                                                		<option value="{{s.id}}" >{{s.name|title}}</option>
                                                		{%endif%}
                                                      {%empty%}
                                                      <option value="-1" selected>not found !</option>
                                                      {%endfor%}
                                                       	
                                                	</select>
                                                	</div>
                                                	</td>
                                                	
                                                	<tr>
                                                	</table>       
                                                </div>
                                           </div>
                                           
                                           <div class='section'>
                                           		<label>Received Amount</label>
                                           		<div>
                                           			<input id='received'  type='text' value='' onchange='setRecAmount(this.value);'/>
                                           		</div>
                                           	</div>
                                           <!---payment div started-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
                                           <div id="div_payment">
                                           
                                           
                                            
                                          
                                           <!--
                                           <div class="section" >
                                                <label>Magazine Combo</label>   
                                                <div class="selectWidth1" >
                                                    
                                                	<select class="small" id="combo"  name="combo" >
                                                		<option value="-1"  selected>Select Magazine Combo</option>
                                                	  {%for c in combos%}
                                                	    {%ifequal combo c.id%}
                                                		<option value="{{c.id}}" selected>{{c.name|title}}/{{c.code|title}}</option>
                                                		{%else%}
                                                		<option value="{{c.id}}" >{{c.name|title}}/{{c.code|title}}</option>
                                                		{%endifequal%}
                                                      {%empty%}
                                                         <option value="-1" > no magazines combo found ! </option>
                                                      {%endfor%}
                                                    </select>
                                                	
                                               </div>
                                                
                                           </div>
                                           -->
                                           <div id="div_only_payment">
                                            &nbsp;&nbsp;&nbsp;
                                           <div class="section" >
                                              <table width="100%" border="0" cellspacing="0" cellpadding="5" bordercolor="#cdcdcd" style="border-collapse:collapse">
                                                  <tr class="tr_bg_list">
                                                      <td width="">Compliment</td>
                                                      <td width="">Magazine</td>
                                                      <td width="">Select</td>
                                                      <td width="">Tenure</td>
                                                      <td width="">MRP Price</td>
                                                      <td width="">Offer Price</td>
                                                      <td width="">Received Amount</td>
                                                  </tr>
                                                  
                                                  {%if mags%}
                                                  {%for m in mags%}
                                                  <tr>
                                                    <td><input name="com_c_{{m.0}}" id="com_c_{{m.0}}" type="checkbox"  value="1" {%if m.7%}checked{%endif%}></td>
                                                    <td>{{m.1|title}}</td>
                                                    <td><input name="c_{{m.0}}" id="c_{{m.0}}" type="checkbox"  value="1" {%if m.2%}checked{%endif%} ></td>
                                                    <td>
                                                        
                                                    	<select class="small" name="t_{{m.0}}" onchange="getMagEstimatedAmnt({{m.0}},this.value,{{mags|length}},{{forloop.counter}});">
                                                    	        <option value="-1"  selected>Select Period</option>
                                                    	    {%for t in tenures%}
                                                    	      {%ifequal m.3 t.timePeriod%}
                                                    	        <option value="{{t.timePeriod}}" selected>{{t.name|title}}</option>
                                                    	      {%else%}
                                                    	        <option value="{{t.timePeriod}}" >{{t.name|title}}</option>
                                                		      {%endifequal%}
                                                		    {%empty%}
                                                                <option value="-1" > no periods found! </option>
                                                            {%endfor%}
                                                       	
                                                	   </select>
                                                	   
                                              			
                                              		</td>
                                              		<td><input type="text" id="estimatedAmount_{{forloop.counter}}" name="estAmnt_{{m.0}}" value="{%if m.4%}{{m.4}}{%else%}0{%endif%}" class="subs_txtbox" readonly/></td>
                                              		<td><input type="text" style="color:red;" name="realAmount_{{m.0}}" id="realAmount_{{forloop.counter}}"  value="{%if m.5%}{{m.5}}{%else%}{%endif%}" class="subs_txtbox"  onchange="calcSUMRA({{mags|length}});getMagIds();"/></td>
                                              		<td><input type="text" style="color:green;" name="recAmount_{{m.0}}" id="recAmount_{{forloop.counter}}"  value="{%if m.6%}{{m.6}}{%else%}{%endif%}" class="subs_txtbox"  onchange="calcSUMRecA({{mags|length}});"/></td>
                                              		
                                              	  </tr>
                                              	  {%endfor%}
                                              	  
                                              	  
                                              	  
	                                              <tr style="background:lightcyan;" >
	                                                 <td colspan="4" align="right"><label>Offer Discount</label></td>
	                                                 <td align="left"><input  name="discount" id="discount" value="{{discount}}" type="text" /></td>
	                                                 
	                                                 <td colspan="1" align="right"><label>Total MRP Price</label></td>
	                                                 <td><input name="sumOfEAmnt"  id="SumOfEAmnt" type="text" value="{{sumOfEAmnt}}"  readonly/></td>
	                                              </tr>
	                                              
	                                              <tr style="background:lightcyan;" >
	                                                 <td colspan="4" align="right"><label>Comission Discount</label></td>
	                                                 <td align="left"><input  name="comdiscount" id='comdis' type="text" value="{{comdiscount}}"/></td>
	                                                 
	                                                 <td colspan="1" align="right" ><label>Total Subscription Price</label></td>
	                                                 <td><input style="color:red;" name="sumOfRAmnt" id="SumOfRAmnt" type="text" value="{{sumOfRAmnt}}" readonly/></td>
	                                              </tr>
	                                              
	                                              <tr style="background:lightcyan;">
	                                                 <td colspan="4" align="right"><label>Additional Discount</label></td>
	                                                 <td align="left"><input name="addiscount" id='addis' type="text" value="{{addiscount}}" /></td>
	                                                 
	                                                 <td colspan="1" align="right"><label>Total Received Amount</label></td>
	                                                 <td><input style="color:green;" name="sumOfRecAmnt" id="SumOfRecAmnt" type="text" value="{{sumOfRecAmnt}}" onchange="setRecAmount(this.value);" readonly/></td>
	                                              </tr>
	                                              <tr style="background:lightcyan;">
	                                                 <td colspan="4" align="right"><label>Other Charges</label></td>
	                                                <td align="left" colspan="3"><input name="ocharges" type="text" id='ocharge' value="{{ocharges}}" /></td>
	                                                 
	                                                 
	                                              </tr>
	                                              {%else%}
	                                              <tr style="background:lightcyan;" >
	                                                 <td colspan="7" align="center">no magazines found !</td>
	                                              </tr>
	                                              {%endif%}
	                                         </table>
                                           </div>
                                           
                                           </div>
                                           
                                           
                                           
                                           
                                           
                                           <div class="section" >
                                                <label>gift</label> 
                                                <div class="selectWidth1" id="giftdiv">
                                                	<select class="small"  id="selectofgifts" name="sgifts" multiple>
                                                		
                                                	  {%for g in gifts%}
                                                	    {%if g.id in sgifts%}
                                                		<option value="{{g.id}}" selected>{{g.name|title}}/{{g.code|title}}</option>
                                                		{%else%}
                                                		<option value="{{g.id}}" >{{g.name|title}}/{{g.code|title}}</option>
                                                		{%endif%}
                                                      
                                                      {%endfor%}
                                                       	
                                                	</select>
                                                	
                                                	        
                                                </div>
                                                
                                           </div>
                                           
                                           
                                           </div>
                                           <!---payment div end-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-->
                                           
                                          <div class="section" >
                                                <label>Belongs to Branch </label>   
                                                <div class="selectWidth1" >
                                                <table border="0">
                                                <tr>
                                                <td>
                                                
                                                <div id="idOf_popBranch">
                                                <select class="small"  name="branch" >
                                                		<option value="-1"  selected>Select Branch</option>
                                                	  {%for b in branches %}
                                                	    {%ifequal customer.branch.id b.id%}
                                                		<option value="{{b.id}}" selected>{{b.name|title}} / {{b.code}}</option>
                                                		{%else%}
                                                		<option value="{{b.id}}" >{{b.name|title}} / {{b.code}}</option>
                                                		{%endifequal%}
                                                      {%empty%}
                                                         <option value="-1" > no branches found ! </option>
                                                      {%endfor%}
                                                       	
                                                	</select> 
                                                </div>
                                                
                                                </td>
                                                <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                <td ><a href="" onclick="return openURLInCenterOfScreen('/add/branch');"><img src="{% static 'images/icon_addlink.gif' %}"></a></td>
                                                </tr>       
                                                </table>
                                                	
                                                	
                                                	        
                                                </div>
                                           </div>
                                           
                                            <div class="section" >
                                                <label>Courier Name</label>   
                                                <div class="selectWidth1">
                                                    <table>
                                                    <tr>
                                                    <td>
                                                	<select class="medium" name="courier" >
                                                	<option value="-1" selected>Select Courier</option>
                                                	  {%for c in couriers%}
                                                	  {% ifequal customer.courier.id c.id %}
                                                	  <option value="{{c.id}}" selected>{{c.name}}</option>
                                                	  {% else %}
                                                        <option value="{{c.id}}">{{c.name}}</option>
                                                	  {% endifequal %}
                                                	  {%empty%}
                                                	  <option value="-1" selected> not found !</option>
                                                	  {%endfor%}
                                                	  
                                                	  		
                                                   </select>
                                                   </td>
                                                   </tr>
                                                   </table>       
                                               </div>
                                           </div> 
                                        <!--   <div class="section" >
                                                <label>Emp. Id </label>   
                                                <div> <input type="text" name="empid" class="medium"  value="{{empid}}" /></div>
                                           </div>
                                         --> 
                                            
                                       
                                </div>
					
			
			</div>                      
  			<div id="step-3">

			            <div class="widget-content">
                                    <!-- title box -->
                                          
                                          <div class="section" >
                                                <label> Subscription Date </label>   
                                                <div> <input type="text" name="date"  value="{{date}}" readonly class="medium"  /></div>
                                          </div>
                                          
                                          <div class="section " >
                                                <label >Received Amount</label>   
                                                <div> <input type="text"  name="TRAForShow" id="forshow" value="{{TRAForShow}}" class="medium"  readonly/></div>

                                        </div>
                                          
                                          <div class="section">
                                                <label>Payment Mode</label>   
                                                <div class="selectWidth1">
                                                <select class="small"  name="paymode" id="paymode" onchange="setPaymentDetails(this.value);">
                                                
                                                <option value="-1" selected >Select Payment Mode</option>
                                                   {%if paymode == 'c'%}
                                                   <option value="c" selected>Cash</option>
                                                   {%else%}
                                                   <option value="c" >Cash</option>
                                                   {%endif%}
                                                   
                                                   {%if paymode == 'd'%}
                                                   <option value="d"  selected>Draft</option>
                                                   {%else%}
                                                   <option value="d" >Draft</option>
                                                   {%endif%}
                                                   
                                                   {%if paymode == 'chq'%}
                                                   <option value="chq"  selected>Cheque</option>
                                                   {%else%}
                                                   <option value="chq" >Cheque</option>
                                                   {%endif%}
                                                   
                                                   {%if paymode == 'a'%}
                                                   <option value="a"  selected>NEFT</option>
                                                   {%else%}
                                                   <option value="a" >NEFT</option>
                                                   {%endif%}
                                                   
                                                   {%if paymode == 'o'%}
                                                   <option value="o"  selected>Online</option>
                                                   {%else%}
                                                   <option value="o" >Online</option>
                                                   {%endif%}
                                                   
                                                   {%if paymode == 'out'%}
                                                   <option value="out"  selected>Outstanding</option>
                                                   {%else%}
                                                   <option value="out" >Outstanding</option>
                                                   {%endif%}



                                              </select>       
                                      </div>
                                           </div>
                                           
                                            
                                                                                                                    
                                        <div class="division">
                                        
                                        <div class="section when_cash" >
                                                <label >Bank Name</label>   
                                                <div> <input type="text" name="bank" value="{{bank}}" class="medium"  /></div>

                                        </div>
                                        <div class="section" >
                                                <label id="pt_no">Cheque DD No.</label>   
                                                <div> <input type="text" name="chequeno" value="{{chequeno}}" class="medium"  /></div>
                                           </div>   
                                        
                                           <div class="section" >
                                                <label id="pt_date">Cheque DD date</label>   
                                                <div> <input type="text" name="chequedate" class="datepicker" style="text-align:left" value="{{chequedate}}" class="medium"  /></div>

                                           </div>
                                           
                                           
                                           
                                                                                      
                                           <div class="section when_online when_cash" >
                                                <label id="pt_ddate">Cheque/DD Deposite Date </label>   
                                                <div> <input type="text" name="depositedate" class="datepicker" style="text-align:left" value="{{depositedate}}" class="medium"  /></div>
                                           </div>
                                           
                                           <div class="section when_cash" >
                                                <label id="pt_cdate">Cheque/DD Clearance Date </label>   
                                                <div> <input type="text" name="cleardate" class="datepicker" style="text-align:left" value="{{cleardate}}" class="medium"  /></div>

                                           </div>
                                       </div>
                                       
                                       
                                            <div class="section last">
                                               <div>
                                                <input type="submit" name="button" class="btn" value="submit"  />
                                               </div>
                                           </div>
                                           <input type="hidden" value="{{warned}}" name="warned"/>
                                </div>
            </p>

			</div>
            
            
         
            </form>
  			
  		</div>
                                        
                                        
{%endblock%}
{%block form1Width%}100%{%endblock%}
{%block form2%}{%endblock%}
{%block form3%}{%endblock%}

